(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7497:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEvents=t.listen=t.isInCache=t.createBlock=void 0,t.createBlock=function(e){return{nodes:[],cache:new Set,parent:e,events:[]}},t.isInCache=function(e,t){let n=t;for(;n;){if(n.cache.has(e))return!0;n=n.parent}return!1},t.listen=function(e,t){e.events.push(t)},t.runEvents=function(e){if(e.events.length){for(const t of e.events)t();e.events.length=0}}},2741:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.UNDEFINED=t._assign=t._arrow_fn=t._ternary=t._arr_binding_decl=t._obj_binding_decl=t._obj=t._for_in=t._for=t._call=t._access=t._not=t._instanceof=t._new=t._arr_check=t._obj_check=t._bool=t._num=t._str=t._throw=t._or=t._and=t._bin_chain=t._typeof_cmp=t._bin=t._ident=t._var=t._if_nest=t._if_chain=t._if=t._concise=t._stmt=t.joinElements=t.concat=void 0;const o=i(n(4625)),s=n(7914);function c(e,t=""){const n=[];for(const r of e){const e=n[n.length-1],a="string"===typeof r?r:o.default.isStringLiteral(r)||o.default.isNumericLiteral(r)?r.text:void 0;""!==a&&(e&&(o.default.isStringLiteral(e)||o.default.isNumericLiteral(e))?void 0!==a?n[n.length-1]=g(e.text+t+a):(t&&(n[n.length-1]=g(e.text+t)),n.push(r)):void 0!==a?n.push(g(e?t+a:""+a)):(t&&e&&n.push(g(t)),n.push(r)))}return n}function l(e){return Array.isArray(e)?o.factory.createBlock(e):o.default.isBlock(e)||e.kind>o.default.SyntaxKind.EmptyStatement&&e.kind<o.default.SyntaxKind.DebuggerStatement?e:o.factory.createExpressionStatement(e)}function u(e){return Array.isArray(e)?o.factory.createBlock(e):o.default.isBlock(e)?e:e.kind>o.default.SyntaxKind.EmptyStatement&&e.kind<o.default.SyntaxKind.DebuggerStatement?o.factory.createBlock([e]):e}function d(e,t,n=o.default.NodeFlags.Let){const r="string"===typeof e?o.factory.createUniqueName(e):e;return[o.factory.createVariableStatement(void 0,o.factory.createVariableDeclarationList([o.factory.createVariableDeclaration(r,void 0,void 0,t)],n)),r]}function f(e,t){return"string"!==typeof e?e:t?o.factory.createIdentifier(e):o.factory.createUniqueName(e)}function p(e,t,n){return o.default.factory.createBinaryExpression(e,n,t)}function y(e,t,n=o.default.SyntaxKind.EqualsEqualsEqualsToken){return o.factory.createBinaryExpression(o.factory.createTypeOfExpression(e),n,o.factory.createStringLiteral(t))}function h(e,t){if(1===e.length)return e[0];let n=o.factory.createBinaryExpression(e[0],t,e[1]);for(let r=2;r<e.length;r++)n=o.factory.createBinaryExpression(n,t,e[r]);return n}function m(e){return h(e,o.default.SyntaxKind.BarBarToken)}function g(e){return o.factory.createStringLiteral(e)}function _(e){return o.factory.createNumericLiteral(e)}function b(e){return e?o.factory.createTrue():o.factory.createFalse()}function T(e,t){return"string"===typeof t?(0,s.isInt)(t)?o.factory.createElementAccessExpression(e,o.default.factory.createNumericLiteral(t)):o.default.factory.createPropertyAccessExpression(e,t):o.factory.createElementAccessExpression(e,t)}function v(e,t){return o.factory.createCallExpression(e,void 0,t)}t.concat=function(e,...t){const n=[];for(let r=0;r<e.length;r++)n.push(e[r]),r<t.length&&n.push(t[r]);return c(n)},t.joinElements=c,t._stmt=l,t._concise=u,t._if=function(e,t,n){return o.factory.createIfStatement(e,l(t),n?l(n):void 0)},t._if_chain=function e(t,n,r){return t>=n.length?r:o.factory.createIfStatement(n[t][0],l(n[t][1]),e(t+1,n,r))},t._if_nest=function e(t,n,r){return t>=n.length?r:o.factory.createIfStatement(n[t][0],e(t+1,n,r),l(n[t][1]))},t._var=d,t._ident=f,t._bin=p,t._typeof_cmp=y,t._bin_chain=h,t._and=function(e){return h(e,o.default.SyntaxKind.AmpersandAmpersandToken)},t._or=m,t._throw=function(e){return o.factory.createThrowStatement(e)},t._str=g,t._num=_,t._bool=b,t._obj_check=function(e,t){return t?y(e,"object",o.default.SyntaxKind.ExclamationEqualsEqualsToken):m([y(e,"object",o.default.SyntaxKind.ExclamationEqualsEqualsToken),p(e,o.default.factory.createNull(),o.default.SyntaxKind.EqualsEqualsEqualsToken)])},t._arr_check=function(e){return v(T(f("Array",!0),"isArray"),[e])},t._new=function(e,t){return o.factory.createNewExpression(f(e,!0),void 0,"string"===typeof t?[o.factory.createStringLiteral(t)]:t)},t._instanceof=function(e,t){return o.factory.createBinaryExpression(e,o.default.SyntaxKind.InstanceOfKeyword,"string"===typeof t?o.factory.createIdentifier(t):t)},t._not=function e(t){if(o.default.isParenthesizedExpression(t))return o.default.factory.createParenthesizedExpression(e(t.expression));if(o.default.isBinaryExpression(t))switch(t.operatorToken.kind){case o.default.SyntaxKind.EqualsEqualsToken:return o.factory.createBinaryExpression(t.left,o.default.SyntaxKind.ExclamationEqualsToken,t.right);case o.default.SyntaxKind.ExclamationEqualsToken:return o.factory.createBinaryExpression(t.left,o.default.SyntaxKind.EqualsEqualsToken,t.right);case o.default.SyntaxKind.EqualsEqualsEqualsToken:return o.factory.createBinaryExpression(t.left,o.default.SyntaxKind.ExclamationEqualsEqualsToken,t.right);case o.default.SyntaxKind.ExclamationEqualsEqualsToken:return o.factory.createBinaryExpression(t.left,o.default.SyntaxKind.EqualsEqualsEqualsToken,t.right);case o.default.SyntaxKind.GreaterThanToken:return o.factory.createBinaryExpression(t.left,o.default.SyntaxKind.LessThanEqualsToken,t.right);case o.default.SyntaxKind.GreaterThanEqualsToken:return o.factory.createBinaryExpression(t.left,o.default.SyntaxKind.LessThanToken,t.right);case o.default.SyntaxKind.LessThanToken:return o.factory.createBinaryExpression(t.left,o.default.SyntaxKind.GreaterThanEqualsToken,t.right);case o.default.SyntaxKind.LessThanEqualsToken:return o.factory.createBinaryExpression(t.left,o.default.SyntaxKind.GreaterThanToken,t.right);case o.default.SyntaxKind.AmpersandAmpersandToken:return o.factory.createBinaryExpression(e(t.left),o.default.SyntaxKind.BarBarToken,e(t.right));case o.default.SyntaxKind.BarBarToken:return o.factory.createBinaryExpression(e(t.left),o.default.SyntaxKind.AmpersandAmpersandToken,e(t.right));default:return o.factory.createPrefixUnaryExpression(o.default.SyntaxKind.ExclamationToken,t)}else if(o.default.isPrefixUnaryExpression(t)&&t.operator===o.default.SyntaxKind.ExclamationToken)return t.operand;return o.factory.createPrefixUnaryExpression(o.default.SyntaxKind.ExclamationToken,t)},t._access=T,t._call=v,t._for=function(e,t,n,r){const[a,i]=d(t,o.factory.createNumericLiteral(0));return[o.factory.createForStatement(a.declarationList,o.factory.createBinaryExpression(i,o.default.SyntaxKind.LessThanToken,r||o.factory.createPropertyAccessExpression(e,"length")),o.factory.createPostfixIncrement(i),l(n)),i]},t._for_in=function(e,t,n){const[r,a]=d(t);return[o.factory.createForInStatement(r.declarationList,e,l(n)),a]},t._obj=function(e){const t=[];for(const n in e){const r=e[n];let a;if(void 0!==r){if("string"===typeof r)a=g(r);else if("number"===typeof r)a=_(r);else if(!0===r)a=b(!0);else if(!1===r)a=b(!1);else{if(!("kind"in r))continue;a=r}t.push(o.factory.createPropertyAssignment(n,a))}}return o.factory.createObjectLiteralExpression(t)},t._obj_binding_decl=function(e,t){return o.factory.createVariableDeclaration(o.factory.createObjectBindingPattern(e.map((e=>o.factory.createBindingElement(void 0,e[1]?e[0]:void 0,e[1]?e[1]:e[0],void 0)))),void 0,void 0,t)},t._arr_binding_decl=function(e,t){const n=[];for(const r of e)n[r[0]]=o.factory.createBindingElement(void 0,void 0,r[1],void 0);for(let r=0;r<n.length;r++)void 0===n[r]&&(n[r]=o.factory.createOmittedExpression());return o.factory.createVariableDeclaration(o.factory.createArrayBindingPattern(n),void 0,void 0,t)},t._ternary=function(e,t,n){return o.factory.createConditionalExpression(e,void 0,t,void 0,n)},t._arrow_fn=function(e,t){return o.factory.createArrowFunction(void 0,void 0,e.map((e=>o.default.factory.createParameterDeclaration(void 0,void 0,f(e)))),void 0,void 0,u(t))},t._assign=function(e,t){return o.factory.createAssignment(e,t)},t.UNDEFINED=o.factory.createIdentifier("undefined")},6313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeToJSONSchema=t.validatorToJSONSchema=void 0;const r=n(8788);function a(e){switch(e.typeData.kind){case r.TypeDataKinds.String:return{type:"string"};case r.TypeDataKinds.Number:return{type:"number"};case r.TypeDataKinds.Check:{if(!e.children.length)return;const t=e.children[0],n=a(t);if(!n)return;for(const a of e.typeData.hints)"int"===a.name?n.type="integer":"min"===a.name?n.minimum=a.value:"max"===a.name?n.maximum=a.value:"minLen"===a.name?t.typeData.kind===r.TypeDataKinds.Array?n.minItems=a.value:n.minLength=a.value:"maxLen"===a.name?t.typeData.kind===r.TypeDataKinds.Array?n.maxItems=a.value:n.maxLength=a.value:"matches"===a.name&&(n.pattern=a.value);return n}case r.TypeDataKinds.Object:{const t={},n=[];for(const r of e.children){const e=r.getNonOptionalValue(),i=r.nameToString();e||n.push(i),t[i]=a(e||r)}return{type:"object",properties:t,required:n,additionalProperties:void 0===e.exactProps()}}case r.TypeDataKinds.Array:return{type:"array",items:e.children[0]?a(e.children[0]):void 0};case r.TypeDataKinds.Tuple:return{type:"array",prefixItems:e.children.map((e=>a(e)))};case r.TypeDataKinds.Union:return{oneOf:e.children.map((e=>a(e)))};case r.TypeDataKinds.Boolean:return{type:"boolean"};case r.TypeDataKinds.Null:return{type:"null"};case r.TypeDataKinds.Recursive:return{$ref:"#"};case r.TypeDataKinds.BigInt:case r.TypeDataKinds.Class:case r.TypeDataKinds.Function:case r.TypeDataKinds.Resolve:case r.TypeDataKinds.Symbol:case r.TypeDataKinds.Undefined:case r.TypeDataKinds.Transform:return}}t.validatorToJSONSchema=a,t.typeToJSONSchema=function(e,t){const n=(0,r.genValidator)(e,t,"origin");if(n)return a(n)}},8019:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.minimizeGenResult=t.fullValidate=t.validateType=t.genStatements=t.genCheckCtx=t.getUnionMembers=t.isNullableNode=t.genChecks=t.genNode=t.error=t.joinResultStmts=t.createContext=void 0;const o=i(n(4625)),s=n(8788),c=n(2741),l=n(7914);function u(e){return[...e.before||[],...e.after||[]]}function d(e,t,n=!1){if(e.resultType.none)return o.default.factory.createReturnStatement();if(e.resultType.return)return o.default.factory.createReturnStatement(e.resultType.return);if(!t)return o.default.factory.createReturnStatement();const r=e.resultType.rawErrors?(0,c._obj)({value:t[0].expression(),valueName:(0,c._bin_chain)((0,c.joinElements)(t[0].path()),o.default.SyntaxKind.PlusToken),expectedType:(0,c._obj)(t[0].getRawTypeData())}):(0,c._bin_chain)(n?t[1]:(0,c.joinElements)(["Expected ",...t[0].path()," ",...t[1]]),o.default.SyntaxKind.PlusToken);if(e.resultType.returnErr)return o.default.factory.createReturnStatement(r);if(e.resultType.throw){let t;if("string"===typeof e.resultType.throw)t=e.resultType.throw;else{t=e.transformer.symbolsToImport.identifierMap.get(e.resultType.throw)||e.resultType.throw.name}return(0,c._throw)((0,c._new)(t,[r]))}return e.resultType.custom?e.resultType.custom(r):(0,c._throw)((0,c._new)("Error",[r]))}function f(e,t){if(e.recursiveOrigins.length){const n=e.recursiveOrigins,r="string"===typeof e.name?e.name:"_recursive",a=[];let i;for(const o of n){const n=(0,c._ident)(r),l=(0,c._ident)("param"),u=(0,s.genValidator)(t.transformer,o,e.name,l);u&&(u.recursiveOrigins.length=0,t.recursiveFnNames.set(o,n),a.push([n,u]),e._original===o&&(i=n))}for(const[e,s]of a){const n=_(s,{...t,resultType:{return:(0,c._bool)(!1)}});t.recursiveFns.push(o.default.factory.createFunctionDeclaration(void 0,void 0,e,void 0,[o.default.factory.createParameterDeclaration(void 0,void 0,s.customExp,void 0,void 0,void 0)],void 0,o.default.factory.createBlock(1===n.length&&(0,l.isSingleIfStatement)(n[0])?[o.default.factory.createReturnStatement((0,c._not)(n[0].expression))]:[...n,o.default.factory.createReturnStatement((0,c._bool)(!0))])))}return i?{condition:(0,c._not)((0,c._call)(i,[e.expression()])),error:[e,[(0,c._str)(`to be ${t.transformer.checker.typeToString(e._original)}`)]]}:(e.recursiveOrigins.length=0,f(e,t))}switch(e.typeData.kind){case s.TypeDataKinds.Number:return void 0!==e.typeData.literal?{condition:(0,c._bin)(e.expression(),(0,c._num)(e.typeData.literal),o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,c.concat`to be equal to ${e.typeData.literal.toString()}`]}:{condition:(0,c._typeof_cmp)(e.expression(),"number",o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,[(0,c._str)("to be a number")]]};case s.TypeDataKinds.String:return void 0!==e.typeData.literal?{condition:(0,c._bin)(e.expression(),(0,c._str)(e.typeData.literal),o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,c.concat`to be equal to "${e.typeData.literal}"`]}:{condition:(0,c._typeof_cmp)(e.expression(),"string",o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,[(0,c._str)("to be a string")]]};case s.TypeDataKinds.Boolean:return{condition:void 0!==e.typeData.literal?(0,c._bin)(e.expression(),(0,c._bool)(e.typeData.literal),o.default.SyntaxKind.ExclamationEqualsEqualsToken):(0,c._and)([(0,c._bin)(e.expression(),(0,c._bool)(!1),o.default.SyntaxKind.ExclamationEqualsEqualsToken),(0,c._bin)(e.expression(),(0,c._bool)(!0),o.default.SyntaxKind.ExclamationEqualsEqualsToken)]),error:[e,[void 0!==e.typeData.literal?(0,c._str)(`to be ${e.typeData.literal}`):(0,c._str)("to be a boolean")]]};case s.TypeDataKinds.BigInt:return{condition:(0,c._typeof_cmp)(e.expression(),"bigint",o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,[(0,c._str)("to be a bigint")]]};case s.TypeDataKinds.Symbol:return{condition:(0,c._typeof_cmp)(e.expression(),"symbol",o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,[(0,c._str)("to be a symbol")]]};case s.TypeDataKinds.Class:return{condition:(0,c._not)((0,c._instanceof)(e.expression(),e._original.symbol.name)),error:[e,[(0,c._str)(`to be an instance of "${e._original.symbol.name}"`)]]};case s.TypeDataKinds.Function:return{condition:(0,c._typeof_cmp)(e.expression(),"function",o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,[(0,c._str)("to be a function")]]};case s.TypeDataKinds.Null:return{condition:(0,c._bin)(e.expression(),o.default.factory.createNull(),o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,[(0,c._str)("to be null")]]};case s.TypeDataKinds.Undefined:return{condition:(0,c._bin)(e.expression(),c.UNDEFINED,o.default.SyntaxKind.ExclamationEqualsEqualsToken),error:[e,[(0,c._str)("to be undefined")]]};case s.TypeDataKinds.Resolve:{const n=t.resolvedTypeArguments.get(e._original);return n?f(n,t):{condition:(0,c._bool)(!1),error:[e,[(0,c._str)("to be a type parameter")]]}}case s.TypeDataKinds.Recursive:{if(!t.recursiveFnNames.has(e._original))return{condition:(0,c._bool)(!1)};const n=t.recursiveFnNames.get(e._original);return{condition:(0,c._not)((0,c._call)(n,[e.expression()])),error:[e,[(0,c._str)(`to be ${t.transformer.checker.typeToString(e._original)}`)]]}}case s.TypeDataKinds.Tuple:{const n=[],r=[],a=e.children.some((e=>!e.isRedirect()&&e.weigh()>4&&"number"===typeof e.name));for(const i of e.children)a&&n.push([i.name,i.setAlias((()=>(0,c._ident)("t")))]),r.push(..._(i,t));return{condition:(0,c._not)((0,c._arr_check)(e.expression())),error:[e,[(0,c._str)("to be an array")]],before:n.length?[o.default.factory.createVariableStatement(void 0,o.default.factory.createVariableDeclarationList([(0,c._arr_binding_decl)(n,e.expression())],o.default.NodeFlags.Const))]:void 0,after:r}}case s.TypeDataKinds.Check:{const n=[],r=e.typeData.hints.filter((e=>e.error)).map((e=>e.error)).join(", ");let a,i,o;if(e.children.length){const r=f(e.children[0],t);n.push(r.condition),a=r.after,i=r.before,o=r.error}return n.push(...p(e.typeData.expressions,e,t,!0)),{condition:(0,c._or)(n),after:a,before:i,error:[e,o?[...o[1],(0,c._str)(", "),(0,c._str)(r)]:[(0,c._str)(r)]]}}case s.TypeDataKinds.Union:{const{compound:n,normal:r,object:a,isNullable:i}=h(e.children),s=[],l=[],p=n.map((e=>f(e,t))),m=e.children.map((e=>t.transformer.checker.typeToString(e._original)));for(const e of r){const n=f(e,t);s.push(n.condition),n.error&&l.push(n.error)}if(a.length&&p.push({condition:(0,c._obj_check)(e.expression()),after:[(0,c._if_nest)(0,a.map((([e,n])=>[f(n,t).condition,u(f(e,t))])),d(t,[e,[(0,c._str)("to be one of "),(0,c._str)(m.join(", "))]]))]}),p.length){if(s.length)return{condition:i?(0,c._and)([y(e),...s]):(0,c._and)(s),ifTrue:(0,c._if_nest)(0,p.map((e=>[e.condition,u(e)])),d(t,[e,[(0,c._str)("to be one of "),(0,c._str)(m.join(", "))]]))};{const n=p.shift();return i?{condition:y(e),ifTrue:[(0,c._if)(n.condition,d(t,n.error)),...u(n),(0,c._if_nest)(0,p.map((e=>[e.condition,u(e)])),o.default.factory.createEmptyStatement())]}:{condition:i?y(e):n.condition,ifTrue:i?(0,c._if)(n.condition,(0,c._if_nest)(0,p.map((e=>[e.condition,u(e)])),d(t,[e,[(0,c._str)("to be one of "),(0,c._str)(m.join(", "))]]))):(0,c._if_nest)(0,p.map((e=>[e.condition,e.after||[]])),d(t,[e,[(0,c._str)("to be one of "),(0,c._str)(m.join(", "))]])),ifFalse:u(n)}}}return{condition:i?(0,c._and)([y(e),...s]):(0,c._and)(s),error:1===s.length?l[0]:[e,[(0,c._str)("to be one of "),(0,c._str)(m.join(", "))]]}}case s.TypeDataKinds.Array:{const n=e.children[0];if(!n)return{condition:(0,c._not)((0,c._call)((0,c._access)((0,c._ident)("Array",!0),"isArray"),[e.expression()])),error:[e,[(0,c._str)("to be an array")]]};let r;return"object"===typeof n.name?r=n.name:(r=(0,c._ident)("i"),n.setName(r)),{condition:(0,c._not)((0,c._arr_check)(e.expression())),error:[e,[(0,c._str)("to be an array")]],after:[(0,c._for)(e.expression(),r,_(n,t))[0]]}}case s.TypeDataKinds.Object:{const n=[],r=[];for(const i of e.children)!i.isRedirect()&&i.weigh()>4&&"string"===typeof i.name&&r.push([i.name,i.setAlias((()=>(0,c._ident)(i.name)))]),n.push(..._(i,t));const a=e.exactProps();if(void 0!==a&&e.children.length){const r=(0,c._ident)("p");n.push((0,c._for_in)(e.expression(),r,[(0,c._if)((0,c._and)(e.children.filter((e=>"string"===typeof e.name)).map((e=>(0,c._bin)(r,(0,c._str)(e.name),o.default.SyntaxKind.ExclamationEqualsEqualsToken)))),1===a?d(t,[e,(0,c.joinElements)(["Property ",...e.path(),".",r," is excessive"])],!0):e.typeData.useDeleteOperator?o.default.factory.createDeleteExpression((0,c._access)(e.expression(),r)):(0,c._bin)((0,c._access)(e.expression(),r),c.UNDEFINED,o.default.SyntaxKind.EqualsToken))])[0])}if(e.typeData.stringIndexInfo||e.typeData.numberIndexInfo){const r=(0,c._ident)("p");let a=[];if(e.typeData.stringIndexInfo){const[n,i]=e.typeData.stringIndexInfo;let o,l;if(n.typeData.kind===s.TypeDataKinds.Check){n.setCustomExpression(r),n.setChildren([]);const a=f(n,t);o=a.condition,l=[e,(0,c.joinElements)(["Expected key ",r," of ",...e.path()," ",...a.error?.[1]||[]])]}i.setName(r),a=o?[(0,c._if)(o,d(t,l,!0)),..._(i,t)]:_(i,t)}if(e.typeData.numberIndexInfo){const[n,i]=e.typeData.numberIndexInfo;i.setName(r);const l=(0,c._not)((0,c._call)((0,c._ident)("isNaN",!0),[r]));let u;if(n.typeData.kind===s.TypeDataKinds.Check){const[a,s]=(0,c._var)("numKey",(0,c._call)((0,c._ident)("parseFloat",!0),[r]),o.default.NodeFlags.Const);n.setCustomExpression(s),n.setName(r),n.setChildren([]);const l=f(n,t);u=[a,(0,c._if)(l.condition,d(t,[e,(0,c.joinElements)(["Expected key ",r," of ",...e.path()," ",...l.error?.[1]||[]])],!0)),..._(i,t)]}else u=_(i,t);a=a?(0,c._if)(l,u,a):(0,c._if)(l,u,d(t,[e,(0,c.joinElements)(["Expected key ",r," of ",...e.path()," to be a number"])],!0))}n.push((0,c._for_in)(e.expression(),r,a)[0])}return{condition:(0,c._obj_check)(e.expression(),e.typeData.couldBeNull),error:[e,[(0,c._str)("to be an object")]],before:r.length?[o.default.factory.createVariableStatement(void 0,o.default.factory.createVariableDeclarationList([(0,c._obj_binding_decl)(r,e.expression())],o.default.NodeFlags.Const))]:void 0,after:n}}case s.TypeDataKinds.Transform:{const n=e.typeData.rest;if(!n)throw(0,l.TransformerError)(t.origin,"Transform has no base type.");return f(n,t)}default:throw(0,l.TransformerError)(t.origin,"Unexpected TypeDataKind.")}}function p(e,t,n,r){const a=[];let i;for(const o of e)if("string"===typeof o){i||(i=m(t));const e=n.transformer.stringToNode(o,i);a.push(r?(0,c._not)(e):e)}else{const e=n.transformer.importSymbol(o,n.origin);if(!e)continue;const i=(0,c._call)(e,[t.expression()]);a.push(r?(0,c._not)(i):i)}return a}function y(e){return(0,c._bin)(e.expression(),c.UNDEFINED,o.default.SyntaxKind.ExclamationEqualsEqualsToken)}function h(e){const t=[],n=[],r=[];let a=!1;const i=e.filter((e=>e.typeData.kind===s.TypeDataKinds.Object)).length;for(const o of e)if(o.typeData.kind!==s.TypeDataKinds.Undefined)if(o.children.length&&o.typeData.kind===s.TypeDataKinds.Object&&i>1){const e=o.getFirstLiteralChild();e?(o.children.splice(o.children.indexOf(e),1),r.push([o,e])):t.push(o)}else o.isComplexType()?t.push(o):n.push(o);else a=!0;return{compound:t,normal:n,object:r,isNullable:a}}function m(e){return{$self:e.expression(),$parent:t=>{let n=t&&(0,o.isNumericLiteral)(t)?+t.text:0,r=e.parent;for(;r&&n--;)r=r.parent;return r?r.expression():c.UNDEFINED}}}function g(e,t){const n=[];for(const r of e)t.useElse&&r.after?n.push((0,c._if)(r.condition,d(t,r.error),u(r))):(n.push((0,c._if)(r.condition,r.ifTrue?r.ifTrue:d(t,r.error),r.ifFalse)),r.before&&n.push(...r.before),r.after&&n.push(...r.after));return[...n]}function _(e,t,n){const r=f(e,t),a=t.resultType.return?b(r,t):r;return n?a.after||a.ifFalse||a.ifTrue||a.before?[(0,c._if)(y(e),g([a],t))]:g([{...a,condition:(0,c._and)([y(e),a.condition])}],t):g([a],t)}function b(e,t,n){if(e.ifFalse)return e;const r=n?c._and:c._or,a=n?c._not:e=>e,i=[];let s=a(e.condition),u=[];if(e.ifTrue){const n=(0,c._concise)(e.ifTrue);if(o.default.isExpression(n))i.push(a(n));else{if(!n.statements.every((e=>o.default.isIfStatement(e)&&!e.elseStatement&&o.default.isReturnStatement(e.thenStatement)||o.default.isEmptyStatement(e))))return e;{const e=[];for(const t of n.statements)o.default.isEmptyStatement(t)||e.push(a(t.expression));s=(0,c._ternary)(s,r(e),t.resultType.return)}}}if(e.after)for(const o of e.after)(0,l.isSingleIfStatement)(o)?i.push(a(o.expression)):u.push(o);if(e.before&&i.length){const n=[],a=[];for(const e of u)o.default.isForStatement(e)?n.push(e):a.push(e);a.push((0,c._if)(r(i),d(t,e.error))),u=[...a,...n]}else s=r([s,...i]);return{condition:s,after:u.length?u:void 0,before:e.before,error:e.error,minimzed:!0}}t.createContext=function(e,t,n,r){return{transformer:e,resultType:t,useElse:r,recursiveFns:[],recursiveFnNames:new Map,resolvedTypeArguments:new Map,origin:n}},t.joinResultStmts=u,t.error=d,t.genNode=f,t.genChecks=p,t.isNullableNode=y,t.getUnionMembers=h,t.genCheckCtx=m,t.genStatements=g,t.validateType=_,t.fullValidate=function(e,t,n){const r=_(e,t,n);return[...t.recursiveFns,...r]},t.minimizeGenResult=b},2974:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.genMatch=t.makeBlock=t.genReplacementStmt=t.genConciseNode=void 0;const a=r(n(4625)),i=n(8788),o=n(2741),s=n(8019),c=n(7914);function l(e,t,n=!0){switch(e.typeData.kind){case i.TypeDataKinds.Array:{const r=e.children[0];if(!r)return{condition:n?(0,o._arr_check)(e.expression()):(0,o._bool)(!0)};const a=(0,o._ident)("value");r.customExp=a;const i=(0,o._call)((0,o._access)(e.expression(),"every"),[(0,o._arrow_fn)([a],l(r,t).condition)]);return{condition:n?(0,o._and)([(0,o._arr_check)(e.expression()),i]):i}}case i.TypeDataKinds.Tuple:{const r=e.children.map((e=>l(e,t).condition));return{condition:n?(0,o._and)([(0,o._arr_check)(e.expression()),...r]):(0,o._and)(r)}}case i.TypeDataKinds.Union:{const{compound:n,normal:r,object:i,isNullable:c}=(0,s.getUnionMembers)(e.children),u=[...r,...n].map((e=>l(e,t,!1).condition));return i.length&&u.push(...i.map((([e,n])=>(0,o._and)([l(n,t,!1).condition,l(e,t,!1).condition])))),{condition:c?(0,o._and)([(0,o._bin)(e.expression(),o.UNDEFINED,a.default.SyntaxKind.ExclamationEqualsEqualsToken),(0,o._or)(u)]):(0,o._or)(u)}}case i.TypeDataKinds.Object:{const r=e.children.map((e=>l(e,t).condition));return{condition:n?(0,o._and)([(0,o._not)((0,o._obj_check)(e.expression(),e.typeData.couldBeNull)),...r]):(0,o._and)(r)}}case i.TypeDataKinds.Check:{const r=(0,s.genChecks)(e.typeData.expressions,e,t,!1),a=e.children[0];return a&&(a.isComplexType()?r.unshift(l(a,t,n).condition):n&&r.unshift(l(a,t).condition)),{condition:(0,o._and)(r)}}default:return{condition:(0,o._not)((0,s.genNode)(e,t).condition)}}}function u(e,t,n,r){if(!r)return a.default.isBlock(n)?n:a.default.factory.createReturnStatement(n);if(a.default.isIdentifier(r.name)){const i=n=>a.default.isIdentifier(n)&&n.text===r.name.getText()?t:a.default.visitEachChild(n,i,e.ctx),o=a.default.visitNode(n,i);return a.default.isBlock(o)?(0,c.doesAlwaysReturn)(o)?o:a.default.factory.createBlock([...o.statements,a.default.factory.createReturnStatement()]):a.default.factory.createReturnStatement(o)}{const e=(0,o._var)(r.name,t)[0];return a.default.isBlock(n)?(0,c.doesAlwaysReturn)(n)?a.default.factory.createBlock([e,...n.statements]):a.default.factory.createBlock([e,...n.statements,a.default.factory.createReturnStatement()]):a.default.factory.createBlock([e,a.default.factory.createReturnStatement(n)])}}function d(e){return a.default.isBlock(e)?e:a.default.factory.createBlock([e])}function f(e,t,n){e.has(t)?e.get(t).push(n):e.set(t,[n])}t.genConciseNode=l,t.genReplacementStmt=u,t.makeBlock=d,t.genMatch=function(e,t,n){const r=t.elements.map((t=>e.checker.getSignatureFromDeclaration(t))).filter((e=>e));if(!r.length)return;const c=(0,o._ident)("value"),p=new Map,y=[];let h;for(const o of r){const t=o.parameters[0];if(!t||!t.valueDeclaration){o.declaration&&a.default.isArrowFunction(o.declaration)&&(h={body:o.declaration.body});continue}const r=t.valueDeclaration;if(!a.default.isArrowFunction(r.parent))continue;const s=r.parent.body,l=(0,i.genValidator)(e,e.checker.getTypeOfSymbolAtLocation(t,t.valueDeclaration),c.text,c);if(l)if(l.typeData.kind===i.TypeDataKinds.Check)if(l.children.length){f(p,l.children[0].typeData.kind,{parameter:r,type:l,body:s})}else y.push({parameter:r,type:l,body:s});else if(l.typeData.kind===i.TypeDataKinds.Union){const t=new Map;for(const e of l.children)f(t,e.typeData.kind,e);for(const[n,a]of t)1===a.length?f(p,n,{parameter:r,type:a[0],body:s}):f(p,n,{parameter:r,type:new i.Validator(e.checker.getAnyType(),c.text,{kind:i.TypeDataKinds.Union},c,void 0,a),body:s})}else if(n&&l.typeData.kind===i.TypeDataKinds.Object){const e=l.getFirstLiteralChild();f(p,l.typeData.kind,e?{parameter:r,type:e,body:s}:{parameter:r,type:l,body:s})}else f(p,l.typeData.kind,{parameter:r,type:l,body:s});else h={parameter:r,body:s}}const m=(0,s.createContext)(e,{},t),g=[...p.entries()].sort(((e,t)=>e[0]===i.TypeDataKinds.Object?1:t[0]===i.TypeDataKinds.Object?-1:e[1].reduce(((e,t)=>t.type.weigh()+e),0)-t[1].reduce(((e,t)=>t.type.weigh()+e),0))),_=[],b=y.map((t=>[l(t.type,m).condition,u(e,c,t.body,t.parameter)]));if(g.length)for(const[a,s]of g){const t=[];let n;for(const a of s){if(a.type.isSimple()){n||(n=a);continue}const r=l(a.type,m,!1);t.push([r.condition,u(e,c,a.body,a.parameter)])}const r=l(n?.type||new i.Validator(e.checker.getAnyType(),c.text,{kind:a},c),m,!0);b.push([r.condition,d((0,o._if_chain)(0,t,n?u(e,c,n.body,n.parameter):void 0))])}if(_.push((0,o._if_chain)(0,b)),h){const t=u(e,c,h.body,h.parameter);a.default.isBlock(t)?_.push(...t.statements):_.push(t)}return a.default.factory.createArrowFunction(void 0,void 0,[a.default.factory.createParameterDeclaration(void 0,void 0,c)],void 0,void 0,a.default.factory.createBlock(_,!0))}},2842:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getMappedType=t.getMappedRawType=t.resolveCheck=t.createUnionValidator=t.createPossibleIntersectionCheckType=t.getCodeReference=t.genValidator=void 0;const a=r(n(4625)),i=n(2846),o=n(7914);function s(e,t,n,r,f){if(t){if(f){const e=f.getParentWithType(t);if(e)return e.recursiveOrigins.push(t),new i.Validator(t,n,{kind:i.TypeDataKinds.Recursive},r,f)}if(t.isStringLiteral())return new i.Validator(t,n,{kind:i.TypeDataKinds.String,literal:t.value},r,f);if(t.isNumberLiteral())return new i.Validator(t,n,{kind:i.TypeDataKinds.Number,literal:t.value},r,f);if((0,o.hasBit)(t,a.default.TypeFlags.String)||(0,o.hasBit)(t,a.default.TypeFlags.TemplateLiteral))return new i.Validator(t,n,{kind:i.TypeDataKinds.String},r,f);if((0,o.hasBit)(t,a.default.TypeFlags.Number))return new i.Validator(t,n,{kind:i.TypeDataKinds.Number},r,f);if((0,o.hasBit)(t,a.default.TypeFlags.BigInt))return new i.Validator(t,n,{kind:i.TypeDataKinds.BigInt},r,f);if((0,o.hasBit)(t,a.default.TypeFlags.Boolean))return new i.Validator(t,n,{kind:i.TypeDataKinds.Boolean},r,f);if((0,o.hasBit)(t,a.default.TypeFlags.ESSymbol))return new i.Validator(t,n,{kind:i.TypeDataKinds.Symbol},r,f);if((0,o.hasBit)(t,a.default.TypeFlags.Null))return new i.Validator(t,n,{kind:i.TypeDataKinds.Null},r,f);if((0,o.hasBit)(t,a.default.TypeFlags.Undefined))return new i.Validator(t,n,{kind:i.TypeDataKinds.Undefined},r,f);if((0,o.hasBit)(t,a.default.TypeFlags.BooleanLiteral))return new i.Validator(t,n,{kind:i.TypeDataKinds.Boolean,literal:(0,o.isTrueType)(t)},r,f);if(!(0,o.hasBit)(t,a.default.TypeFlags.AnyOrUnknown)){if(t.isClass())return new i.Validator(t,n,{kind:i.TypeDataKinds.Class},r,f);if(!t.isTypeParameter()){if(e.checker.isTupleType(t))return new i.Validator(t,n,{kind:i.TypeDataKinds.Tuple},r,f,(n=>e.checker.getTypeArguments(t).map(((t,r)=>s(e,t,r,void 0,n)))));if(e.checker.isArrayType(t))return new i.Validator(t,n,{kind:i.TypeDataKinds.Array},r,f,(n=>[s(e,e.checker.getTypeArguments(t)[0],"",void 0,n)]));if(t.symbol&&(0,o.hasBit)(t.symbol,a.default.SymbolFlags.FunctionScopedVariable)&&(0,o.hasBit)(t.symbol,a.default.SymbolFlags.Interface)&&t.symbol.valueDeclaration){const a=e.checker.getTypeOfSymbolAtLocation(t.symbol,t.symbol.valueDeclaration).symbol;return a.members&&a.members.has("__new")?new i.Validator(t,n,{kind:i.TypeDataKinds.Class},r,f):void 0}if(1===t.getCallSignatures().length)return new i.Validator(t,n,{kind:i.TypeDataKinds.Function},r,f);{if(t.getProperty("__$transform")){const a=[];let o;const u=(t,i)=>{const l=t.aliasTypeArguments?.[0];if(l){if(e.checker.isTupleType(l))for(const t of e.checker.getTypeArguments(l)){const e=c(t);e&&a.push(e)}else{const e=c(l);e&&a.push(e)}if(i){const a=t.aliasTypeArguments?.[1];a&&(o=s(e,a,n,r,f))}}};if(t.isIntersection()){const a=[];for(const e of t.types)e.getProperty("__$transform")?e.aliasTypeArguments?.length&&u(e,!1):a.push(e);o=1===a.length?s(e,a[0],n,r,f):l(t,a,e,n,r,f)}else u(t,!0);return new i.Validator(t,n,{kind:i.TypeDataKinds.Transform,transformations:a,rest:o},r,f)}if(t.getProperty("__$check")){if(t.isIntersection())return l(t,t.types,e,n,r,f);{const e=t;let o,s;if(e.mapper)if(e.mapper.kind===a.default.TypeMapKind.Simple&&e.mapper.target.isStringLiteral())o=e.mapper.target.value;else{const t=d(e,0);if(!t)return;o=t,s={error:p(e,1),name:p(e,2),value:p(e,3)}}if(!o)return;return new i.Validator(t,n,{kind:i.TypeDataKinds.Check,expressions:[o],hints:s?[s]:[]},r,f)}}const y=e.getPropType(t,"name");if(!y||!y.isStringLiteral()){if(t.isUnion())return u(t,t.types,e,n,r,f);const a=n=>t.getProperties().map((t=>{const r=e.checker.getTypeOfSymbol(t)||e.checker.getNullType();return s(e,r,t.name,void 0,n)})),o=new i.Validator(t,n,{kind:i.TypeDataKinds.Object},r,f,a);for(const n of t.indexInfos||[]){const t=s(e,n.keyType,"",void 0,o);if(!t)continue;const r=s(e,n.type,"",void 0,o);r&&(t.getBaseType()===i.TypeDataKinds.String?o.typeData.stringIndexInfo=[t,r]:t.getBaseType()===i.TypeDataKinds.Number&&(o.typeData.numberIndexInfo=[t,r]))}return o}switch(y.value){case"NoCheck":default:return;case"ExactProps":{const a=s(e,e.getPropType(t,"type"),n,r,f);if(!a||a.typeData.kind!==i.TypeDataKinds.Object)return;return a.typeData.exact=(0,o.isTrueType)(e.getPropType(t,"removeExcessive"))?0:1,a.typeData.useDeleteOperator=(0,o.isTrueType)(e.getPropType(t,"useDeleteOprerator")),a}case"Infer":{const a=t.aliasTypeArguments?.[0];if(!a||!a.isTypeParameter())return;const c=(0,o.getCallSigFromType)(e.checker,a);if(!c||!c.instantiations)return;const l=[];if(c.instantiations.forEach((t=>{const[n]=(0,o.getResolvedTypesFromCallSig)(e.checker,[a],t);if(!n)return;const i=s(e,n,"",r,f);i&&l.push(i)})),l.length){if(1===l.length){const e=l[0];return new i.Validator(e._original,n,e.typeData,r,f,e.children)}return new i.Validator(t,n,{kind:i.TypeDataKinds.Union},r,f,l)}return}case"Resolve":{const e=t.aliasTypeArguments?.[0];if(!e||!e.isTypeParameter()||e.symbol.parent&&(0,o.hasBit)(e.symbol.parent,a.default.SymbolFlags.Class))return;return new i.Validator(t,n,{kind:i.TypeDataKinds.Resolve,type:e},r,f)}}}}}}}function c(e){return e.isStringLiteral()?e.value:e.symbol?e.symbol:void 0}function l(e,t,n,r,o,l){const u=[],f=[];let y;for(const i of t){const e=i,t=n.getPropType(e,"name");if(t&&t.isStringLiteral()&&!e.getProperty("__$check"))y=e;else if(e.mapper)if(e.mapper.kind===a.default.TypeMapKind.Simple){const t=c(e.mapper.target);t&&u.push(t)}else{const t=d(e,0);if(!t)continue;u.push(t),f.push({error:p(e,1),name:p(e,2),value:p(e,3)})}else y||(y=i)}if(u.length)return new i.Validator(e,r,{kind:i.TypeDataKinds.Check,expressions:u,hints:f},o,l,y?e=>[s(n,y,"",void 0,e)]:void 0)}function u(e,t,n,r,a,o){let c=!1,l=-1,u=-1;return new i.Validator(e,r,{kind:i.TypeDataKinds.Union},a,o,(e=>{let r=[];for(let a=0;a<t.length;a++){const o=t[a],d=s(n,o,"",void 0,e);d&&(d.typeData.kind===i.TypeDataKinds.Null?c=!0:d.typeData.kind===i.TypeDataKinds.Object?d.typeData.couldBeNull=c:d.typeData.kind===i.TypeDataKinds.Boolean&&(!0===d.typeData.literal?u=a:!1===d.typeData.literal&&(l=a)),r.push(d))}return-1!==u&&-1!==l&&(r=[...r.filter(((e,t)=>t!==u&&t!==l)),new i.Validator(n.checker.getBooleanType(),"",{kind:i.TypeDataKinds.Boolean},void 0,e)]),r}))}function d(e,t){const n=f(e,t);if(n)return c(n)}function f(e,t){if(!("mapper"in e))return;const n=e.mapper;let r;return n.kind===a.default.TypeMapKind.Simple?r=n.target:n.kind===a.default.TypeMapKind.Array&&n.targets&&(r=n.targets[t]),r?r.isUnion()?r.types[r.types.length-1]:r:void 0}function p(e,t){const n=f(e,t);if(n&&n.isLiteral())return n.value}t.genValidator=s,t.getCodeReference=c,t.createPossibleIntersectionCheckType=l,t.createUnionValidator=u,t.resolveCheck=d,t.getMappedRawType=f,t.getMappedType=p},8788:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(2842),t),a(n(2846),t)},2846:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Validator=t.TypeDataKinds=void 0;const a=r(n(4625)),i=n(2741),o=n(7914);var s;!function(e){e[e.Number=0]="Number",e[e.String=1]="String",e[e.Array=2]="Array",e[e.Boolean=3]="Boolean",e[e.Symbol=4]="Symbol",e[e.BigInt=5]="BigInt",e[e.Null=6]="Null",e[e.Undefined=7]="Undefined",e[e.Tuple=8]="Tuple",e[e.Object=9]="Object",e[e.Class=10]="Class",e[e.Function=11]="Function",e[e.Union=12]="Union",e[e.Resolve=13]="Resolve",e[e.Recursive=14]="Recursive",e[e.Check=15]="Check",e[e.Transform=16]="Transform"}(s||(t.TypeDataKinds=s={}));class c{_original;_exp;customExp;name;parent;typeData;children;recursiveOrigins;constructor(e,t,n,r,a,i){this._original=e,this.name=t,this.typeData=n,this.customExp=r,this.recursiveOrigins=[],a&&this.setParent(a),i?"function"===typeof i?this.setChildren(i(this).filter((e=>e))):this.setChildren(i,!0):this.children=[]}nameAsExpression(){return"object"===typeof this.name?this.name:(0,o.isInt)(this.name)?a.default.factory.createNumericLiteral(this.name):a.default.factory.createStringLiteral(this.name)}nameToString(){return"string"===typeof this.name?this.name:"number"===typeof this.name?this.name.toString():this.name.text}path(){if(!this.parent)return[this.nameAsExpression()];const e=this.parent.path();return""===this.name||("object"===typeof this.name?e.push("[",this.name,"]"):(0,o.isInt)(this.name)?e.push(`[${this.name}]`):e.push(`.${this.name}`)),e}expression(){return this.customExp?this.customExp:this._exp?this._exp:this.parent?""===this.name?this.parent.expression():this._exp=(0,i._access)(this.parent.expression(),this.name):a.default.factory.createNull()}isRedirect(){return this.typeData.kind===s.Recursive||this.typeData.kind===s.Union&&2===this.children.length&&this.hasChildrenOfKind(s.Undefined,s.Recursive)}isComplexType(){switch(this.typeData.kind){case s.Check:return!!this.children.length&&this.children[0].isComplexType();case s.Object:case s.Tuple:case s.Union:case s.Array:return!0;default:return!1}}setParent(e){this.parent=e,delete this._exp}setChildren(e,t){if(t)for(const n of e)n.parent=this;e.sort(((e,t)=>e.weigh()-t.weigh())),this.children=e}setAlias(e){return delete this._exp,this.customExp||(this.customExp=e()),this.customExp}setName(e){this.name=e,delete this._exp}setCustomExpression(e){this.customExp=e,delete this._exp}hasChildrenOfKind(...e){const t=new Set;for(const n of this.children)e.includes(n.typeData.kind)&&t.add(n.typeData.kind);return t.size===e.length}getChildrenOfKind(e){const t=[];this.typeData.kind===e&&t.push(this);for(const n of this.children)t.push(...n.getChildrenOfKind(e));return t}areChildrenSameKind(){if(!this.children.length)return!0;const e=this.children[0].typeData.kind;for(let t=1;t<this.children.length;t++)if(this.children[t].typeData.kind!==e)return!1;return!0}getFirstLiteralChild(){for(const e of this.children)if(e.typeData.kind===s.String&&void 0!==e.typeData.literal||e.typeData.kind===s.Number&&void 0!==e.typeData.literal)return e}getParentWithType(e){let t=this;for(;t;){if(t._original.symbol&&t._original.symbol===e.symbol)return t;t=t.parent}}getNonOptionalValue(){if(this.typeData.kind===s.Union&&2===this.children.length){if(this.children[0].typeData.kind===s.Undefined)return this.children[1];if(this.children[1].typeData.kind===s.Undefined)return this.children[0]}}exactProps(){let e=this;for(;e;){if(e.typeData.kind===s.Object&&void 0!==e.typeData.exact)return e.typeData.exact;e=e.parent}}weigh(){let e=0;switch(this.typeData.kind){case s.Number:if(this.typeData.literal)return 0;e++;break;case s.String:if(this.typeData.literal)return.5;e++;break;case s.Boolean:return this.typeData.literal?0:.5;case s.Array:e+=10;break;case s.Union:case s.Resolve:break;case s.Null:case s.Undefined:e+=1;break;case s.Symbol:case s.BigInt:case s.Function:case s.Class:case s.Tuple:e+=3;break;case s.Object:(this.typeData.exact||this.typeData.stringIndexInfo||this.typeData.numberIndexInfo)&&(e+=8),e+=3;break;case s.Recursive:return 10;case s.Check:e+=this.typeData.expressions.length}return this.children.reduce(((e,t)=>e+t.weigh()),e)}getBaseType(){return this.typeData.kind===s.Check&&this.children.length?this.children[0].typeData.kind:this.typeData.kind}isSimple(){switch(this.typeData.kind){case s.Number:case s.String:case s.Boolean:return void 0===this.typeData.literal;case s.Object:case s.Array:case s.Tuple:case s.Check:return 0===this.children.length;case s.Union:return!1;default:return!0}}getRawTypeData(){if(this.typeData.kind===s.Check){const e=this.children[0]?this.children[0].getRawTypeData():{kind:s.Check};for(const t of this.typeData.hints)t.name&&(e[t.name]=t.value);return e}return this.typeData}clone(){return new c(this._original,this.name,{...this.typeData},this._exp,this.parent,this.children.map((e=>e.clone())))}}t.Validator=c},3349:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});const i=n(249);t.default=(e,t)=>n=>{const r=new i.Transformer(e,n,t||{});return e=>r.run(e)},a(n(9814),t)},9814:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Functions=t.Markers=void 0;const s=o(n(4625)),c=i(n(7497)),l=n(7914),u=n(8019),d=n(8788),f=n(2741),p=n(2974);t.Markers={Assert:(e,{exp:t,block:n,parameters:r,optional:a})=>{const i=(0,l.resolveResultType)(e,r[1]);i.throw&&"string"!==typeof i.throw&&e.importSymbol(i.throw,t);let o=t;if(!s.default.isIdentifier(o)&&!s.default.isBindingName(o)){const[e,t]=(0,f._var)("value",o,s.default.NodeFlags.Const);n.nodes.push(e),o=t}return n.nodes.push(...(0,l.forEachVar)(o,((n,o)=>{const c=function(e,t,n,r,a,i){const o=(0,d.genValidator)(e,t,n,r);if(!o)return;const s=o.getChildrenOfKind(d.TypeDataKinds.Resolve);if(s.length){const t=(0,l.getCallSigFromType)(e.checker,s[0].typeData.type);if(t){const n=e.toBeResolved.get(t.declaration);return void(n?n.push({validators:s,optional:i,top:o,resultType:a}):e.toBeResolved.set(t.declaration,[{validators:s,optional:i,top:o,resultType:a}]))}}return o}(e,void 0!==o?e.checker.getTypeAtLocation(n):r[0],s.default.isIdentifier(n)?n.text:n.getText(),n,i,a);return c?(0,u.fullValidate)(c,(0,u.createContext)(e,i,t),a):[]}))),o}},t.Functions={is:(e,t)=>{let n,r=t.call.arguments[0];s.default.isIdentifier(r)||([n,r]=(0,f._var)("value",r,s.default.NodeFlags.Const));const a=(0,d.genValidator)(e,t.parameters[0],r.text,r);if(!a)return;const i=(0,u.createContext)(e,{return:s.default.factory.createFalse()},t.call),o=(0,u.minimizeGenResult)((0,u.genNode)(a,i),i);if(o.minimzed&&!o.after&&!o.before){const e=t.block.parent||t.block;return n&&e.nodes.push(n),i.recursiveFns.length&&e.nodes.push(...i.recursiveFns),(0,f._not)(o.condition)}{n&&t.block.nodes.push(n);const e=(0,u.genStatements)([o],i),r=e.pop();s.default.isIfStatement(r)&&s.default.isReturnStatement(r.thenStatement)?t.block.nodes.push(...e,s.default.factory.createReturnStatement((0,f._not)(r.expression))):t.block.nodes.push(...e,r,s.default.factory.createReturnStatement(s.default.factory.createTrue()))}},check:(e,t)=>{let n,r,a,i,o=t.block;if(s.default.isVariableDeclaration(t.call.parent)&&s.default.isArrayBindingPattern(t.call.parent.name)){const e=t.call.parent.name;e.elements[0]&&s.default.isBindingElement(e.elements[0])&&s.default.isIdentifier(e.elements[0].name)?(n=e.elements[0].name,a=(0,f._var)(n,t.call.arguments[0],s.default.NodeFlags.Const)[0]):s.default.isIdentifier(t.call.arguments[0])?n=t.call.arguments[0]:[a,n]=(0,f._var)("value",t.call.arguments[0],s.default.NodeFlags.Const),e.elements[1]&&s.default.isBindingElement(e.elements[1])&&s.default.isIdentifier(e.elements[1].name)?(r=e.elements[1].name,i=(0,f._var)(r,s.default.factory.createArrayLiteralExpression(),s.default.NodeFlags.Const)[0]):[i,r]=(0,f._var)("value",s.default.factory.createArrayLiteralExpression(),s.default.NodeFlags.Const),o=t.prevBlock,c.listen(o,(()=>o.nodes.pop()))}else s.default.isIdentifier(t.call.arguments[0])?n=t.call.arguments[0]:[a,n]=(0,f._var)("value",t.call.arguments[0],s.default.NodeFlags.Const),[i,r]=(0,f._var)("value",s.default.factory.createArrayLiteralExpression(),s.default.NodeFlags.Const);a&&o.nodes.push(a),o.nodes.push(i);const p=(0,d.genValidator)(e,t.parameters[0],n.text,n);p&&(o.nodes.push(...(0,u.fullValidate)(p,(0,u.createContext)(e,{rawErrors:(0,l.isTrueType)(t.parameters[1]),custom:e=>s.default.factory.createExpressionStatement((0,f._call)((0,f._access)(r,"push"),[e]))},t.call,!0))),o===t.block&&o.nodes.push(s.default.factory.createReturnStatement(s.default.factory.createArrayLiteralExpression([n,r]))))},createMatch:(e,t)=>{if(!t.call.arguments[0])throw(0,l.TransformerError)(t.call,"Missing first parameter.");if(!s.default.isArrayLiteralExpression(t.call.arguments[0]))throw(0,l.TransformerError)(t.call.arguments[0],"First parameter must be an array literal.");const n=!!t.call.arguments[1]&&(0,l.isTrueType)(e.checker.getTypeAtLocation(t.call.arguments[1]));return(0,p.genMatch)(e,t.call.arguments[0],n)}}},249:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Transformer=void 0;const s=o(n(4625)),c=i(n(7497)),l=n(9814),u=n(7914),d=n(2741),f=n(8788),p=n(8019),y=n(6313);t.Transformer=class{checker;program;config;ctx;toBeResolved;validatedDecls;symbolsToImport;constructor(e,t,n){this.checker=e.getTypeChecker(),this.program=e,this.ctx=t,this.config=n,this.toBeResolved=new Map,this.validatedDecls=new Map,this.symbolsToImport={identifierMap:new Map,importStatements:[]}}run(e){if(e.isDeclarationFile)return e;const t=this.visitEach(e.statements),n=[...this.symbolsToImport.importStatements,...t];return this.symbolsToImport={identifierMap:new Map,importStatements:[]},s.default.factory.updateSourceFile(e,n)}importSymbol(e,t){if(this.symbolsToImport.identifierMap.has(e))return this.symbolsToImport.identifierMap.get(e);const n=(0,u.importSymbol)(t.getSourceFile(),e);return n?(this.symbolsToImport.importStatements.push(n[0]),this.symbolsToImport.identifierMap.set(e,n[1]),n[1]):s.default.factory.createIdentifier(e.escapedName)}visitEach(e,t=c.createBlock()){for(const n of e){const e=this.visitor(n,t);e&&(Array.isArray(e)?t.nodes.push(...e):t.nodes.push(e),c.runEvents(t))}return t.nodes}visitor(e,t){if(s.default.isFunctionLikeDeclaration(e)){if(this.validatedDecls.has(e))return this.validatedDecls.get(e);if(this.validatedDecls.set(e,e),!e.body)return e;const n=c.createBlock(t);for(const t of e.parameters)this.callMarker(t.type,n,{exp:t.name,optional:Boolean(t.questionToken)});if(s.default.isBlock(e.body))this.visitEach(e.body.statements,n);else{const t=s.default.visitNode(e.body,(e=>this.visitor(e,n)));n.nodes.push(s.default.factory.createReturnStatement(t))}let r;return r=s.default.isFunctionDeclaration(e)?s.default.factory.createFunctionDeclaration(e.modifiers,e.asteriskToken,e.name,e.typeParameters,e.parameters,e.type,s.default.factory.createBlock(n.nodes,!0)):s.default.isArrowFunction(e)?s.default.factory.createArrowFunction(e.modifiers,e.typeParameters,e.parameters,e.type,e.equalsGreaterThanToken,s.default.factory.createBlock(n.nodes,!0)):s.default.isMethodDeclaration(e)?s.default.factory.createMethodDeclaration(e.modifiers,e.asteriskToken,e.name,e.questionToken,e.typeParameters,e.parameters,e.type,s.default.factory.createBlock(n.nodes,!0)):s.default.isGetAccessorDeclaration(e)?s.default.factory.createGetAccessorDeclaration(e.modifiers,e.name,e.parameters,e.type,s.default.factory.createBlock(n.nodes,!0)):s.default.isSetAccessorDeclaration(e)?s.default.factory.createSetAccessorDeclaration(e.modifiers,e.name,e.parameters,s.default.factory.createBlock(n.nodes,!0)):s.default.isConstructorDeclaration(e)?s.default.factory.createConstructorDeclaration(e.modifiers,e.parameters,s.default.factory.createBlock(n.nodes,!0)):s.default.factory.createFunctionExpression(e.modifiers,e.asteriskToken,e.name,e.typeParameters,e.parameters,e.type,s.default.factory.createBlock(n.nodes,!0)),this.validatedDecls.set(e,r),r}if(s.default.isAsExpression(e)){let n=(0,u.resolveAsChain)(e);const r=this.checker.getSymbolAtLocation(n);if(r){if(c.isInCache(r,t))return e;t.cache.add(r)}n=s.default.visitEachChild(n,(e=>this.visitor(e,t)),this.ctx);const a=this.callMarker(e.type,t,{exp:n});return a?s.default.isExpressionStatement(e.parent)?void 0:a[1]:e}if(s.default.isBlock(e))return s.default.factory.createBlock(this.visitEach(e.statements,c.createBlock(t)));if(s.default.isCallExpression(e)){const n=this.checker.getResolvedSignature(e);if(n&&n.declaration&&s.default.isFunctionLikeDeclaration(n.declaration)){const r=n.declaration;if(this.validatedDecls.has(r)||this.validatedDecls.set(r,s.default.visitNode(r,(e=>this.visitor(e,t)))),this.toBeResolved.has(r)){const t=[],a=[],i=[];for(let n=0;n<r.parameters.length;n++){const t=r.parameters[n];if(!s.default.isIdentifier(t.name))throw(0,u.TransformerError)(t,"You cannot deconstruct a parameter which contains a Resolve<T> type.");const o=e.arguments[n]||t.initializer||d.UNDEFINED;if(s.default.isIdentifier(o))a.push(o);else{const[r,o]=(0,d._var)(t.name,e.arguments[n]||t.initializer,s.default.NodeFlags.Const);a.push(o),i.push(r)}}e:for(const o of this.toBeResolved.get(r)){const r=(0,p.createContext)(this,o.resultType,e),a=(0,u.getResolvedTypesFromCallSig)(this.checker,o.validators.map((e=>e.typeData.type)),n);if(a.length)for(let e=0;e<a.length;e++){const t=o.validators[e];if(!t||!a[e])continue e;const n=(0,f.genValidator)(this,a[e],t.name,t.customExp,t.parent);if(!n)continue e;r.resolvedTypeArguments.set(t._original,n)}t.push(...(0,p.fullValidate)(o.top,r,o.optional))}return t.length?s.default.factory.createImmediatelyInvokedArrowFunction([...i,...t,s.default.factory.createReturnStatement(s.default.factory.updateCallExpression(e,e.expression,e.typeArguments,a))]):e}}if(e.arguments[0]){const n=e.expression,r=this.checker.getTypeAtLocation(n).getCallSignatures()[0]?.getTypeParameters();if(r){const n=r.find((e=>e.default&&e.default.getProperty("__$marker")));if(n){const r=n.default.getProperty("__$marker");if(r.valueDeclaration){const n=this.checker.getTypeOfSymbolAtLocation(r,r.valueDeclaration);if(n&&n.isStringLiteral()){const r=c.createBlock(t),a=l.Functions[n.value](this,{call:e,block:r,prevBlock:t,parameters:e.typeArguments?.map((e=>this.checker.getTypeAtLocation(e)))||[]});return a||s.default.factory.createImmediatelyInvokedArrowFunction(r.nodes)}}}}}}else if(s.default.isTypeDeclaration(e)&&this.config.jsonSchema){const t=n(1864);if(this.config.jsonSchema?.types){if(this.config.jsonSchema.types.includes(e.symbol.name)){const n=(0,y.typeToJSONSchema)(this,this.checker.getTypeAtLocation(e));n&&this.program.writeFile(t.join(this.config.jsonSchema.dist,`${e.symbol.name}.json`),JSON.stringify(n),!1)}}else if(this.config.jsonSchema.typePrefix){if(e.symbol.name.startsWith(this.config.jsonSchema.typePrefix)){const n=(0,y.typeToJSONSchema)(this,this.checker.getTypeAtLocation(e));n&&this.program.writeFile(t.join(this.config.jsonSchema.dist,`${e.symbol.name}.json`),JSON.stringify(n),!1)}}else{const n=(0,y.typeToJSONSchema)(this,this.checker.getTypeAtLocation(e));n&&this.program.writeFile(t.join(this.config.jsonSchema.dist,`${e.symbol.name}.json`),JSON.stringify(n),!1)}}return s.default.visitEachChild(e,(e=>this.visitor(e,t)),this.ctx)}callMarker(e,t,n){if(!e||!s.default.isTypeReferenceNode(e))return;const r=this.checker.getTypeAtLocation(e);if(!r)return;const a=this.getPropType(r,"marker");if(!a||!a.isStringLiteral())return;const i=this.getPropType(r,"marker_params");return i&&this.checker.isTupleType(i)?[r,l.Markers[a.value](this,{block:t,parameters:this.checker.getTypeArguments(i)||e.typeArguments?.map((e=>this.checker.getTypeAtLocation(e)))||[],...n})]:void 0}getPropType(e,t){const n=e.getProperty(`__$${t}`);if(n&&n.valueDeclaration)return this.checker.getNonNullableType(this.checker.getTypeOfSymbolAtLocation(n,n.valueDeclaration))}resolveActualType(e){const t=e.getProperty("__$marker");if(t&&t.valueDeclaration)return this.checker.getNonNullableType(this.checker.getTypeOfSymbolAtLocation(t,t.valueDeclaration))}typeValueToNode(e,t,n){if(e.isStringLiteral())return s.default.factory.createStringLiteral(e.value);if(e.isNumberLiteral())return s.default.factory.createNumericLiteral(e.value);if((0,u.hasBit)(e,s.default.TypeFlags.BigIntLiteral)){const{value:t}=e;return s.default.factory.createBigIntLiteral(t)}if(e.isUnion()){const n=e.types.map((e=>this.typeValueToNode(e,!0)));return t?n[0]:n}if("false"===e.intrinsicName)return s.default.factory.createFalse();if("true"===e.intrinsicName)return s.default.factory.createTrue();if("null"===e.intrinsicName)return s.default.factory.createNull();{const t=this.getPropType(e,"name");if(t&&t.isStringLiteral()&&"Expr"===t.value){const t=this.getPropType(e,"type");return t&&t.isStringLiteral()?this.stringToNode(t.value,n):d.UNDEFINED}return d.UNDEFINED}}stringToNode(e,t){const n=s.default.createSourceFile("expr",e,s.default.ScriptTarget.ESNext,!1,s.default.ScriptKind.JS).statements[0];if(!n||!s.default.isExpressionStatement(n))return d.UNDEFINED;const r=e=>s.default.isIdentifier(e)?t&&t[e.text]&&"object"===typeof t[e.text]?t[e.text]:s.default.factory.createIdentifier(e.text):t&&s.default.isCallExpression(e)&&s.default.isIdentifier(e.expression)&&t[e.expression.text]&&"function"===typeof t[e.expression.text]?t[e.expression.text](...e.arguments):s.default.visitEachChild(s.default.factory.cloneNode(e),r,this.ctx);return s.default.visitNode(n.expression,r)}typeToString(e){if(e.isStringLiteral())return e.value;if(e.isNumberLiteral())return e.value.toString();{const t=this.getPropType(e,"name");if(t&&t.isStringLiteral()&&"Expr"===t.value){return this.getPropType(e,"type")&&t.isStringLiteral()?t.value:""}return""}}}},7914:function(e,t,n){"use strict";var r=n(3454),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.importSymbol=t.TransformerErrorWrapper=t.TransformerError=t.doesAlwaysReturn=t.isSingleIfStatement=t.isInt=t.forEachVar=t.resolveResultType=t.getResolvedTypesFromCallSig=t.getCallSigFromType=t.getApparentType=t.createListOfStr=t.getObjectFromType=t.resolveAsChain=t.isTrueType=t.hasBit=void 0;const i=a(n(4625));function o(e){return!!e&&"true"===e.intrinsicName}function s(e,t){return t.isStringLiteral()?e.getStringType():t.isNumberLiteral()?e.getNumberType():t}function c(e,t,n,a){if(!i.default.sys||"object"!==typeof r)throw new Error(n);console.error(i.default.formatDiagnosticsWithColorAndContext([{category:i.default.DiagnosticCategory.Error,code:8e3,file:a,start:e,length:t,messageText:n}],{getNewLine:()=>"\r\n",getCurrentDirectory:i.default.sys.getCurrentDirectory,getCanonicalFileName:e=>e}))}t.hasBit=function(e,t){return 0!==(e.flags&t)},t.isTrueType=o,t.resolveAsChain=function(e){for(;i.default.isAsExpression(e);)e=e.expression;return e},t.getObjectFromType=function(e,t,n){const r={},a=t.aliasTypeArguments?.[n];if(!a)return{};for(const i of a.getProperties())r[i.name]=e.getTypeOfSymbol(i);return r},t.createListOfStr=function(e){if(1===e.length)return e[0]+".";const t=[...e],n=t.pop();return`${t.join(", ")} and ${n}.`},t.getApparentType=s,t.getCallSigFromType=function(e,t){const n=t.getSymbol();if(n&&n.declarations?.length)return e.getSignatureFromDeclaration(n.declarations[0].parent)},t.getResolvedTypesFromCallSig=function(e,t,n){if(!n.mapper)return[];const r=[];let a,o;if(n.mapper.kind===i.default.TypeMapKind.Simple)a=[n.mapper.source],o=[n.mapper.target];else{if(n.mapper.kind!==i.default.TypeMapKind.Array||!n.mapper.targets)return r;a=n.mapper.sources,o=n.mapper.targets}const c=a.map((e=>{const t=e;return t.mapper&&t.mapper.kind===i.default.TypeMapKind.Composite&&t.mapper.mapper1.kind===i.default.TypeMapKind.Simple?t.mapper.mapper1.source:t}));for(let i=0;i<t.length;i++){const n=c.indexOf(t[i]);-1!==n&&r.push(s(e,o[n]))}return r},t.resolveResultType=function(e,t){if(!t)return{throw:"Error"};const n=t.getProperty("__$raw_error")&&o(e.checker.getTypeOfSymbol(t.getProperty("__$raw_error")));return t.getProperty("__$error_msg")?{returnErr:!0,rawErrors:n}:t.getProperty("__$throw_err")?{throw:e.checker.getTypeOfSymbol(t.getProperty("__$throw_err")).symbol,rawErrors:n}:{return:e.typeValueToNode(t),rawErrors:n}},t.forEachVar=function e(t,n,r){if(i.default.isIdentifier(t))return n(t,r);if(i.default.isQualifiedName(t))return n(t.right,r);if(i.default.isObjectBindingPattern(t)){const r=[];for(const a of t.elements)r.push(...e(a.name,n,0));return r}if(i.default.isArrayBindingPattern(t)){const r=[];for(const a of t.elements)i.default.isOmittedExpression(a)||r.push(...e(a.name,n,1));return r}return n(t)},t.isInt=function(e){return!isNaN(+e)},t.isSingleIfStatement=function(e){return i.default.isIfStatement(e)&&i.default.isReturnStatement(e.thenStatement)&&!e.elseStatement},t.doesAlwaysReturn=function e(t){if(i.default.isReturnStatement(t))return!0;if(i.default.isThrowStatement(t))return!0;if(i.default.isIfStatement(t)&&t.elseStatement)return e(t.elseStatement);if(i.default.isBlock(t)){const n=t.statements[t.statements.length-1];return!!n&&e(n)}return!1},t.TransformerError=function(e,t){c(e.pos,e.end-e.pos,t,e.getSourceFile()),r.exit()},t.TransformerErrorWrapper=c,t.importSymbol=function(e,t){if(!t.valueDeclaration)return;const n=t.valueDeclaration.getSourceFile();if(n===e)return;const r=n.symbol?.exports;if(!r)return;const a=i.default.getRelativePathFromFile(e.fileName,n.fileName,(e=>e)).replace(".ts",".js").replace(".mts",".mjs");let o,s;const c=i.default.factory.createIdentifier(t.name);r.get("default")===t?(o=i.default.factory.createImportClause(!1,c,void 0),s=o.name):(o=i.default.factory.createImportClause(!1,void 0,i.default.factory.createNamedImports([i.default.factory.createImportSpecifier(!1,void 0,c)])),s=o.namedBindings.elements[0]);const l=i.default.factory.createImportDeclaration(void 0,o,i.default.factory.createStringLiteral(a),void 0);i.default.setParentRecursive(l,!1);const u=i.default.factory.createIdentifier(t.name);if(s){i.default.getOrCreateEmitNode(u).generatedImportReference=s}return[l,u]}},3841:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=3841,e.exports=t},5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(6277)}])},6277:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return A},default:function(){return F}});var r=n(5893),a=n(5423),i=n.n(a),o=n(3349),s=n.n(o);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l='\ntype Assert<T, ReturnValue = ThrowError<Error>> = T & { __$marker?: "Assert", __$marker_params?: [T, ReturnValue] };\ntype ErrorMsg<_rawErrorData = false> = { __$error_msg: true, __$raw_error: _rawErrorData };\ntype ThrowError<ErrorType = Error, _rawErrorData = false> = { __$throw_err: ErrorType, __$raw_error: _rawErrorData };\ninterface ValidationError {\n    valueName: string,\n    value: unknown,\n    expectedType: {\n        [key: string]: string | number,\n        kind: number\n    }\n};\ntype NoCheck<T> = T & {  __$name?: "NoCheck" };\ntype ExactProps<Obj extends object, removeExcessive = false, useDeleteOperator = false> = Obj & { __$type?: Obj, __$removeExcessive?: removeExcessive, __$useDeleteOprerator?: useDeleteOperator, __$name?: "ExactProps" };\ntype Expr<Expression extends string> = { __$type?: Expression, __$name?: "Expr" };\ntype Check<Cond extends string | ((value: unknown) => any), Err extends string = never, ID extends string = any, Value extends string | number = any> = unknown & { __$check?: Cond, __$error?: Err, __$value?: Value, __$id?: ID, __$name?: "Check" };\ntype Min<T extends string | number> = number & Check<`$self >= ${T}`, `to be greater than ${T}`, "min", T>;\ntype Max<T extends string | number> = number & Check<`$self <= ${T}`, `to be less than ${T}`, "max", T>;\ntype Float = number & Check<"$self % 1 !== 0", "to be a float", "float">;\ntype Int = number & Check<"$self % 1 === 0", "to be an int", "int">;\ntype MinLen<T extends string | number> = Check<`$self.length >= ${T}`, `to have a length greater than ${T}`, "minLen", T>;\ntype MaxLen<T extends string | number> = Check<`$self.length <= ${T}`, `to have a length less than ${T}`, "maxLen", T>;\ntype Length<T extends string | number> = Check<`$self.length === ${T}`, `to have a length equal to ${T}`, "length", T>;\ntype Matches<T extends string> = string & Check<`${T}.test($self)`, `to match ${T}`, "matches", T>;\ntype Eq<T, Expr extends string> = NoCheck<T> & Check<`$self === ${Expr}`, `to be equal to "${Expr}"`, "eq", Expr>;\ntype Not<T extends Check<string, string>> = Check<`!(${T["__$check"]})`, `not ${T["__$error"]}`>;\ntype Or<L extends Check<string, string>, R extends Check<string, string>> = Check<`${L["__$check"]} || ${R["__$check"]}`, `${L["__$error"]} or ${R["__$error"]}`>;\ntype Infer<Type> = Type & { __$name?: "Infer" };\ntype Resolve<Type> = Type & { __$name?: "Resolve" };\n\ndeclare function is<T, _M = { __$marker: "is" }>(prop: unknown) : prop is T;\ndeclare function check<T, _rawErrorData extends boolean = false, _M = { __$marker: "check" }>(prop: unknown) : [T, Array<_rawErrorData extends true ? ValidationError : string>];\ndeclare function createMatch<R, U = unknown, _M = { __$marker: "createMatch" }>(fns: ((val: any) => R)[], noDiscriminatedObjAssert?: boolean) : (val: U) => R;\n',u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){c(e,t,n[t])}))}return e}({},i().getDefaultCompilerOptions(),{noImplicitAny:!0,strictNullChecks:!0,target:i().ScriptTarget.ESNext});var d=n(7294),f=n(3764);function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){var t=(0,f.Ik)();return(0,d.useEffect)((function(){if(t){t.languages.typescript.javascriptDefaults.setCompilerOptions(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){p(e,t,n[t])}))}return e}({},u));var e="ts:ts-runtime-checks/index.d.ts";t.languages.typescript.javascriptDefaults.addExtraLib(l,e),t.editor.createModel(l,"typescript",t.Uri.parse(e))}}),[t]),(0,r.jsx)(f.ZP,{height:"calc(90vh - 50px)",language:"typescript",theme:"vs-dark",value:e.code,onChange:e.onChange})}var h,m=n(5884),g=n(8836),_=n.n(g),b=n(4204),T=n.n(b);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){return null!=t&&"undefined"!==typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(c){s=!0,a=c}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||E(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){if(e){if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function D(e){switch(e){case h.Log:return(0,r.jsxs)("span",{className:_().code,children:["[",(0,r.jsx)("span",{style:{color:"#236cfc",fontWeight:"bold"},children:"LOG"}),"]:"]});case h.Error:return(0,r.jsxs)("span",{className:_().code,children:["[",(0,r.jsx)("span",{style:{color:"#961a1a",fontWeight:"bold"},children:"ERR"}),"]:"]});case h.Warn:return(0,r.jsxs)("span",{className:_().code,children:["[",(0,r.jsx)("span",{style:{color:"orange",fontWeight:"bold"},children:"WARN"}),"]:"]})}}function w(e,t,n,a){return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("span",{className:_().code,children:[(0,r.jsx)("span",{className:_().classNameIdent,children:t.constructor&&t.constructor.name&&"Object"!==t.constructor.name&&t.constructor.name+" "||""}),a||"","{",(0,r.jsx)("br",{}),(0,r.jsx)("span",{children:e.map((function(e,t){var a=k(e,2),i=a[0],o=a[1];return(0,r.jsxs)("span",{children:[!!t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:_().comma,children:", "}),(0,r.jsx)("br",{})]}),(0,r.jsxs)("span",{children:["  ".repeat(n||2),i,": ",j(o,(n||2)+1)]})]},t)}))}),(0,r.jsx)("br",{}),"  ".repeat(n?n-1:1)+"}"]})})}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("string"===typeof e)return(0,r.jsxs)("span",{className:"".concat(_().code," ").concat(_().string),children:['"',e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),'"']});if("number"===typeof e)return(0,r.jsx)("span",{className:"".concat(_().code," ").concat(_().number),children:e});if("function"===typeof e)return(0,r.jsx)("span",{className:_().code,children:"[Function]"});if(void 0===e)return(0,r.jsx)("span",{className:"".concat(_().code," ").concat(_().keyword),children:"undefined"});if(null===e)return(0,r.jsx)("span",{className:"".concat(_().code," ").concat(_().keyword),children:"null"});if(!0===e)return(0,r.jsx)("span",{className:"".concat(_().code," ").concat(_().keyword),children:"true"});if(!1===e)return(0,r.jsx)("span",{className:"".concat(_().code," ").concat(_().keyword),children:"false"});if(Array.isArray(e))return(0,r.jsxs)("span",{className:_().code,children:["[",e.map((function(e,n){return(0,r.jsxs)("span",{children:[!!n&&(0,r.jsx)("span",{className:_().comma,children:", "}),j(e,t+1)]},n)})),"]"]});if(x(e,Map))return w(S(e.entries()),e,t,"(".concat(e.size,") "));if(x(e,Set))return(0,r.jsxs)("span",{className:_().code,children:[(0,r.jsx)("span",{className:_().classNameIdent,children:"Set "}),"(",e.size,")"," {",S(e.values()).map((function(e,n){return(0,r.jsxs)("span",{children:[!!n&&(0,r.jsx)("span",{className:_().comma,children:", "}),j(e,t+1)]},n)})),"}"]});var n=Object.entries(e);return 0===n.length?(0,r.jsx)(r.Fragment,{children:"{}"}):w(n,e,t)}function N(e){var t=(0,d.useState)([]),n=t[0],a=t[1],i=(0,d.useState)("100%"),o=i[0],s=i[1],c=(0,d.useRef)(null),l=(0,d.useRef)(null),u=function(){c.current&&s("".concat(window.innerHeight-c.current.clientHeight-165,"px"))};(0,d.useEffect)((function(){u(),function(){var e=l.current;e&&(e.scrollTop=e.scrollHeight)}()}),[n]);var p={log:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];a(S(n).concat(S(t.map((function(e){return{kind:h.Log,message:e}})))))},warn:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];a(S(n).concat(S(t.map((function(e){return{kind:h.Warn,message:e}})))))},error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];a(S(n).concat(S(t.map((function(e){return{kind:h.Error,message:e}})))))}};return(0,r.jsxs)(m.Z,{split:"horizontal",defaultSize:"70%",primary:"first",onDragFinished:u,children:[(0,r.jsxs)("div",{style:{width:"100%"},ref:c,children:[(0,r.jsx)(f.ZP,{height:"80vh",language:"javascript",theme:"vs-dark",value:T()(e.code),options:{readOnly:!0}}),";"]}),(0,r.jsxs)("div",{className:_().runSection,children:[(0,r.jsx)("button",{className:_().button,onClick:function(){try{new Function("console",e.code)(p)}catch(t){x(t,Error)&&p.error(t.message)}},children:"Run"}),(0,r.jsx)("button",{className:_().button,onClick:function(){return a([])},children:"Clear"}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{className:_().runSectionResult,style:{height:o},ref:l,children:n.map((function(e,t){return(0,r.jsxs)("div",{children:[!!t&&(0,r.jsx)("div",{className:_().logSeparator}),D(e.kind)," ",j(e.message)]},t)}))})]})]})}!function(e){e[e.Log=0]="Log",e[e.Error=1]="Error",e[e.Warn=2]="Warn"}(h||(h={}));var O=n(6961),C=(n(1864),'\n// Interactive playground! Write in your code and see it getting transpiled on the left!\ninterface User {\n    name: string,\n    id: number & Min<10>\n}\n\nfunction validate(user: Assert<User>) {\n    // Your code...\n}\n\nvalidate({ name: "abc", id: 4 });\n');function K(e){var t=e.transpile,n=(0,d.useState)(C),a=n[0],i=n[1],o=(0,d.useState)(""),s=o[0],c=o[1];return(0,d.useEffect)((function(){var e=Object.fromEntries(new URLSearchParams(window.location.search).entries());if(e.code){var n=(0,O.decompressFromEncodedURIComponent)(e.code);if(!n)return;i(n);var r=t(n),a=r.code,o=r.error;c(a||""+o)}else c(t(C).code)}),[]),(0,r.jsxs)("div",{className:_().app,children:[(0,r.jsxs)("header",{className:_().header,children:[(0,r.jsxs)("div",{style:{display:"flex"},children:[(0,r.jsx)("h2",{children:"Typescript runtime checks"}),(0,r.jsx)("button",{className:_().button,onClick:function(){a&&navigator.permissions.query({name:"clipboard-write"}).then((function(e){"granted"!=e.state&&"prompt"!=e.state||navigator.clipboard.writeText(location.origin+location.pathname+"?code=".concat((0,O.compressToEncodedURIComponent)(a)))}))},children:"Copy Link"})]}),(0,r.jsx)("a",{href:"https://github.com/GoogleFeud/ts-runtime-checks",style:{fontSize:"24px"},children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",fill:"currentColor",viewBox:"0 0 16 16",children:(0,r.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"})})})]}),(0,r.jsx)("div",{className:_().mainContent,children:(0,r.jsxs)(m.Z,{split:"vertical",defaultSize:"50%",primary:"first",children:[(0,r.jsx)(y,{code:a,onChange:function(e){i(e);var n=t(e||""),r=n.code,a=n.error;c(r||""+a)}}),(0,r.jsx)(N,{code:s})]})}),(0,r.jsx)("footer",{className:_().footer,children:(0,r.jsxs)("p",{children:["Made with \u2764\ufe0f by ",(0,r.jsx)("a",{href:"https://github.com/GoogleFeud",children:"GoogleFeud"}),"."]})})]})}var A=!0;function F(e){var t=function(e){var t=i().createSourceFile("lib.d.ts",e+l,u.target||i().ScriptTarget.ESNext,!0,i().ScriptKind.TS);return function(e){var n=i().createSourceFile("module.ts",e,u.target||i().ScriptTarget.ESNext,!0),r="",a={getSourceFile:function(e){return e.endsWith(".d.ts")?t:"module.ts"===e?n:void 0},getDefaultLibFileName:function(){return"lib.d.ts"},useCaseSensitiveFileNames:function(){return!1},writeFile:function(e,t){return r=t},getCanonicalFileName:function(e){return e},getCurrentDirectory:function(){return""},getNewLine:function(){return"\n"},fileExists:function(){return!0},readFile:function(){return""},directoryExists:function(){return!0},getDirectories:function(){return[]}},o=i().createProgram(["module.ts"],u,a);try{o.emit(void 0,void 0,void 0,void 0,{before:[s()(o)]})}catch(c){return{error:c}}return{code:r}}}(e.lib);return(0,r.jsx)(K,{transpile:t})}},8836:function(e){e.exports={app:"App_app__8ih7_",header:"App_header__3xFa8",mainContent:"App_mainContent__k7OS5",footer:"App_footer__qJi0F",button:"App_button__Z9okP",runSection:"App_runSection__ptbmi",runSectionResult:"App_runSectionResult__ZpuvE",code:"App_code__SP5sZ",number:"App_number__XeXtQ",string:"App_string__VMgjU",keyword:"App_keyword__MoW95",comma:"App_comma__YKHTd",classNameIdent:"App_classNameIdent__UHLq5",logSeparator:"App_logSeparator__VBwEH",Pane:"App_Pane__XZBvi"}},3411:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=3411,e.exports=t},7424:function(){},9107:function(){},444:function(){},6170:function(){},1157:function(){},1638:function(){},2147:function(){},1206:function(){},2183:function(){},3024:function(){},2715:function(){},3611:function(){},8353:function(){},1210:function(){},7488:function(){},1480:function(){}},function(e){e.O(0,[138,21,538,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);